---
import BaseLayout from "./BaseLayout.astro";
import "../styles/post.scss";

const { title, description, author, date, lastmod } = Astro.props;
---

<BaseLayout title={title} description={description}>
    <main>
        <div class="header">
            {
                lastmod ? (
                    <time datetime={lastmod.toISOString()}>
                        {lastmod.toDateString()}
                    </time>
                ) : (
                    <time datetime={date.toISOString()}>
                        {date.toDateString()}
                    </time>
                )
            }
            <h1>{title}</h1>
            <h3>{description}</h3>
            <p>Written by {author}</p>
        </div>
        <slot />
        <button
            type="button"
            id="scrollToTop"
            onclick="window.scrollTo({top:0, behavior:'smooth'});"
            title="Go to top"
        >
            <p>Back to top</p>
        </button>
    </main>
    <script>
        let button = document.getElementById("scrollToTop");

        button!.style.display = "flex";
        window.onscroll = function () {
            if (window.scrollY > 64) {
                button!.style.opacity = "1";
            } else {
                button!.style.opacity = "0";
            }
        };
    </script>
    <script>
        var headings = document.querySelectorAll(
            "h2, h3:not(.header h3), h4, h5, h6"
        );
        for (var heading of headings) {
            heading.innerHTML = `<a href="#${heading.id}">${heading.innerHTML}</a>`;
        }
    </script>
</BaseLayout>
